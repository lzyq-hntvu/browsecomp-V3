# Browsecomp-V3 科普文档

**目标读者**：想要了解 Browsecomp-V3 系统工作原理的读者

---

## 目录

1. [什么是 Browsecomp-V3？](#1-什么是-browsecomp-v3)
2. [核心概念：推理链模板](#2-核心概念推理链模板)
3. [问题是如何生成的？](#3-问题是如何生成的)
4. [常见误区澄清](#4-常见误区澄清)
5. [系统架构图解](#5-系统架构图解)

---

## 1. 什么是 Browsecomp-V3？

### 一句话介绍

Browsecomp-V3 是一个**复杂学术问题自动生成器**，它能像出题老师一样，自动创作出需要多步推理才能解决的学术谜题。

### 为什么需要它？

想象你是学术领域的人工智能测评人员，你需要：

- ❌ **简单问题**："爱因斯坦在哪一年发表相对论？" → 太简单，AI直接背答案
- ✅ **复杂问题**："一篇2005年前发表的5人合著论文，其中一位作者名字与国家名相同，3位作者隶属同一大学，另外2位在1994年曾合作发表文章，其中一位1990年创立诊所并于2019年在奥地利医学会议演讲。这篇论文8个词标题，引用27条文献。标题是什么？"

这种问题需要 AI **真正理解**并**多步推理**，这就是 Browsecomp-V3 生成的问题类型。

---

## 2. 核心概念：推理链模板

### 什么是推理链模板？

**推理链模板** = 问题生成的**食谱**

就像菜谱告诉你如何一步步做出一道菜，推理链模板告诉我们如何一步步"构造"出一个复杂问题。

### 7种模板（A-G）

| 模板 | 名称 | 占比 | 推理路径 |
|------|------|------|----------|
| **A** | 论文-作者-机构链 | 30% | Paper → Author → Institution |
| **B** | 人物-学术轨迹链 | 22% | Education → Awards → Positions |
| **C** | 引用网络链 | 15% | Citation relationships |
| **D** | 合作网络链 | 10% | Multi-paper collaboration |
| **E** | 活动参与链 | 16% | Conference presentations |
| **F** | 技术内容链 | 5% | Technical content analysis |
| **G** | 致谢关系链 | 2% | Acknowledgment relationships |

### 模板A的"食谱"

```
模板A：论文-作者-机构链的生成步骤
────────────────────────────────────────
1. 从知识图谱中随机选择一篇论文
2. 检查论文的属性：
   - 发表年份是否 < 2010？
   - 作者数量是否 = 5？
   - 标题词数是否 = 8？
   - 引用数量是否 = 27？
3. 沿着"作者"关系遍历：
   - 有没有作者名字等于国家名？
4. 沿着"机构"关系遍历：
   - 是否有3位作者隶属同一机构？
5. 回溯查找历史合作：
   - 其他2位作者在1994年是否合作过？
6. 检查作者成就：
   - 是否有人1990年创立诊所？
   - 是否有人2019年在奥地利演讲？
7. 如果所有条件都满足 → 生成自然语言问题！
```

---

## 3. 问题是如何生成的？

### 生成流程：藏宝图 + 漏斗模型

Browsecomp-V3 使用混合模型生成问题：

```
┌─────────────────────────────────────────────────────────┐
│              问题生成流程（8个步骤）                      │
└─────────────────────────────────────────────────────────┘

步骤1: 选择模板
        ↓
   从7个模板(A-G)中随机选择一个

步骤2: 藏宝图阶段 - 保证答案存在
        ↓
   从真实知识图谱中采样约束值
   例如：publication_year = 2008, author_count = 5
   （这样确保答案一定存在！）

步骤3: 约束实例化
        ↓
   将采样值转换为约束对象
   {"type": "temporal", "operator": "<", "value": 2010}

步骤4: 漏斗阶段 - 逐层过滤
        ↓
   在知识图谱中执行查询
   Paper → Author → Institution
   每一步都过滤掉不符合条件的节点

步骤5: 候选筛选
        ↓
   从剩余候选中选择最终答案

步骤6: 生成问题
        ↓
   用自然语言模板填充约束
   "A paper published before 2010 was authored by..."

步骤7: 质量验证
        ↓
   检查问题是否唯一、语法正确

步骤8: 输出
        ↓
   保存为 JSON/Markdown 格式
```

### 一个具体例子

```
输入：模板A + 知识图谱
─────────────────────────────────────────────────────
1. 系统从KG中找到一篇论文：
   "Treatment of Parkinson's Disease"

2. 提取论文的约束值：
   - year: 2008 (< 2010 ✓)
   - author_count: 5 ✓
   - title_words: 8 ✓
   - references: 27 ✓

3. 遍历作者关系：
   作者：[Georgia, Ben, Chris, David, Peru]
   发现：作者名 "Georgia" = 国家名 ✓

4. 遍历机构关系：
   3位作者隶属：Harvard Medical School ✓

5. 回溯历史合作：
   Ben 和 Chris 在1994年合著过论文 ✓

6. 检查作者成就：
   Peru 1990年创立诊所，2019年奥地利演讲 ✓

7. 生成问题：
   "A paper published before 2010 was authored by five
   individuals, one of whom has a name that is identical
   to that of a country... What is the title?"

8. 答案："Treatment of Parkinson's Disease"
```

---

## 4. 常见误区澄清

### 误区1：推理链模板是用来回答问题的？

| 你的想法 | 实际情况 |
|---------|---------|
| ❌ 模板A → LLM按路径推理 → 找到答案 | ✅ 模板A → 生成复杂问题 |

**正确理解**：
- 推理链模板是**问题生成器**的"食谱"
- 它告诉系统如何在知识图谱中**构造**问题
- 不是用来回答问题的

### 误区2：生成的包含推理路径，LLM能直接推理？

| 你的想法 | 实际情况 |
|---------|---------|
| ❌ 问题中包含推理链，LLM能自动推理 | ✅ 问题只描述约束，需要额外系统回答 |

**正确理解**：
- 生成的问题只是**自然语言描述**
- 要让AI回答这类问题，需要：
  - **方案A**：构建知识图谱查询系统（Browsecomp-V3的方式）
  - **方案B**：给LLM写专门的推理提示词

### 误区3：V3是一个完整的问答系统？

| 你的想法 | 实际情况 |
|---------|---------|
| ❌ V3能生成问题也能回答问题 | ✅ V3只负责生成问题 |

**正确理解**：
- V3 = 问题生成器（Question Generator）
- 要构建完整问答系统，还需要：
  - 问题解析器（Constraint Parser）
  - 知识图谱查询引擎（KG Query Engine）
  - 答案验证器（Answer Verifier）

---

## 5. 系统架构图解

### 完整的问答系统架构

```
┌─────────────────────────────────────────────────────────────┐
│                  完整问答系统（理想状态）                      │
└─────────────────────────────────────────────────────────────┘

                     [知识图谱]
                          │
          ┌───────────────┴───────────────┐
          │                               │
    [问题生成器]                    [问题回答器]
   (Browsecomp-V3)                    (待开发)
          │                               │
          ↓                               ↓
   复杂学术问题                      用户提问
          │                               │
          └───────────────┬───────────────┘
                          ↓
                     [答案]
```

### V3当前的架构

```
┌─────────────────────────────────────────────────────────────┐
│              Browsecomp-V3：问题生成器                        │
└─────────────────────────────────────────────────────────────┘

[知识图谱]
      │
      ↓
[模板选择器] → 选择模板A-G
      │
      ↓
[约束生成器] → 从KG采样约束值
      │
      ↓
[图遍历引擎] → 按模板路径执行查询
      │
      ↓
[问题生成器] → 转换为自然语言
      │
      ↓
[质量验证器] → 检查唯一性、语法
      │
      ↓
[输出] → JSON/Markdown格式问题
```

### 问题回答器（需要额外开发）

```
┌─────────────────────────────────────────────────────────────┐
│              问题回答器（待开发）                              │
└─────────────────────────────────────────────────────────────┘

[用户问题]
      │
      ↓
[约束解析器] → 提取约束条件
      │
      ↓
[模板选择器] → 选择合适的推理模板
      │
      ↓
[图查询引擎] → 在KG中执行查询
      │
      ↓
[答案验证器] → 验证答案满足所有约束
      │
      ↓
[答案]
```

---

## 6. 与LLM的关系

### LLM在V3中的角色

| 阶段 | LLM的作用 | 说明 |
|------|----------|------|
| 问题生成 | 🟡 部分使用 | 生成自然语言表述 |
| 约束采样 | 🔴 不使用 | 从KG直接采样 |
| 图遍历 | 🔴 不使用 | NetworkX图算法 |
| 质量验证 | 🔴 不使用 | 规则检查 |
| 问题回答 | 🔴 不使用 | 需要单独开发 |

### 如何让LLM回答生成的问题？

#### 方案A：提示词工程

```markdown
# 学术问答推理提示词

你是一个专业的学术研究助手。用户会问你复杂的学术论文相关问题。

## 推理步骤
1. 分解问题：识别所有约束条件
2. 确定推理链：选择合适的模板（A-G）
3. 逐步验证：在知识图谱中查找
4. 综合答案：验证所有条件后给出答案

## 示例
问题：一篇2005年前的5人合著论文...

推理过程：
- 约束1：publication_year < 2010
- 约束2：author_count = 5
- 约束3：存在 author.name = country.name
- 推理路径：Paper → Author → Institution
- 查询KG：找到满足条件的论文
- 验证：所有约束都满足
- 答案："Treatment of Parkinson's Disease"
```

#### 方案B：构建KG查询系统

```python
# 这是更可靠的方案
def browsecomp_qa_system(question):
    # 1. 解析问题 → 约束
    constraints = parse_constraints(question)

    # 2. 选择模板
    template = select_template(constraints)

    # 3. 在KG中执行查询
    candidates = query_kg(template, constraints)

    # 4. 验证答案
    answer = verify_and_select(candidates, constraints)

    return answer
```

---

## 7. 总结

### 关键要点

1. **推理链模板 = 问题生成的食谱**
   - 不是用来回答问题的
   - 是用来构造复杂问题的

2. **V3 = 问题生成器**
   - 负责生成复杂学术问题
   - 不负责回答问题

3. **要回答生成的问题，需要额外开发**
   - 方案A：给LLM写专门的推理提示词
   - 方案B：构建知识图谱查询系统（推荐）

4. **核心优势**
   - 自动生成复杂问题
   - 保证答案存在性
   - 多样性问题类型
   - 可验证的答案

### 扩展阅读

- `推理链模板.md` - 7种模板的详细定义
- `PROJECT_MEMORY.md` - 项目完整上下文
- `GENERATION_MECHANISM_ANALYSIS.md` - 生成机制深度分析

---

**文档版本**: v1.0
**最后更新**: 2026-02-04
**作者**: Browsecomp-V3 团队
